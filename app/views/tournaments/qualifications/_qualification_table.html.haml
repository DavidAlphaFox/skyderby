%table.table.qualification-table
  %thead
    %tr
      %td
        Rank
      %td
        Competitor
      %td
        Best result
      - @tournament.qualification_rounds.each do |round|
        %td= "Round #{round.order}"
  %tbody
    - qualification_results.each_with_index do |result, index|
      %tr
        %td= index + 1
        %td
          %a{href: profile_path(result[:profile_id])}
            = result[:name]
        %td= result[:best_result]
        - @tournament.qualification_rounds.each do |round|
          - round_result = result["round_#{round.order}"]
          - track_id = result["round_#{round.order}_track_id"]
          - record_id = result["round_#{round.order}_result_id"]
          - if track_id
            %td.text-right
              %a{href: track_path(track_id), data: {toggle: 'tooltip'}, title: t('.show_details')}
                = round_result
              - if policy(@tournament).update?
                = link_to edit_tournament_qualification_jump_path(@tournament, record_id), remote: true do
                  %i.fa.fa-pencil.text-muted
          - elsif round_result || !policy(@tournament).update?
            %td.text-right
              = round_result
          - else
            %td.text-center.create-result-cell
              - if policy(@tournament).update?
                = link_to new_tournament_qualification_jump_path(@tournament), 
                          remote: true, 
                          'data-params': { 'qualification_jump[tournament_competitor_id]' => result[:id],
                                           'qualification_jump[qualification_round_id]' => round.id}.to_param,
                          class: 'create-result-cell__link',
                          rel: 'nofollow' do
                  %i.fa.fa-upload

